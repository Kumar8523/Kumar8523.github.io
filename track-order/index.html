<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>অর্ডার ট্র্যাকার | আপনার অর্ডার স্ট্যাটাস চেক করুন</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tiro+Bangla&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Tiro Bangla', serif;
        }
        .step-connector {
            height: 2px;
            flex-grow: 1;
            background-color: #e5e7eb;
        }
        .step-connector.active {
            background-color: #10b981;
        }
        .mobile-step-connector {
            width: 2px;
            height: 40px;
            background-color: #e5e7eb;
            margin-left: 23px;
        }
        .mobile-step-connector.active {
            background-color: #10b981;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-10">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">আপনার অর্ডার স্ট্যাটাস ট্র্যাক করুন</h1>
            <p class="text-gray-600">অর্ডার আইডি দিয়ে খুঁজুন এবং বর্তমান অবস্থান জানুন</p>
        </div>

        <!-- Search Box -->
        <div class="max-w-lg mx-auto bg-white rounded-xl shadow-md p-6 mb-12">
            <div class="flex flex-col sm:flex-row gap-4">
                <input 
                    type="text" 
                    id="orderId" 
                    placeholder="আপনার অর্ডার আইডি লিখুন" 
                    class="flex-grow px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent text-gray-700"
                >
                <button 
                    onclick="trackOrder()"
                    class="px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition duration-200 flex items-center justify-center"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                    </svg>
                    খুঁজুন
                </button>
            </div>
        </div>

        <!-- Results Section -->
        <div id="results" class="hidden">
            <!-- Order Details -->
            <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-md overflow-hidden mb-8">
                <div class="p-6">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center">
                        <div>
                            <h2 class="text-xl font-semibold text-gray-800" id="order-id-display"></h2>
                            <p class="text-gray-600 mt-1">অর্ডার তারিখ: <span id="order-date"></span></p>
                        </div>
                        <div class="mt-4 md:mt-0">
                            <span class="px-4 py-2 rounded-full text-sm font-medium" id="status-badge"></span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Desktop Timeline -->
            <div id="desktop-timeline" class="hidden md:block bg-white rounded-xl shadow-md p-8 mb-8">
                <div class="flex items-center justify-between">
                    <!-- Steps will be inserted here by JavaScript -->
                </div>
            </div>

            <!-- Mobile Timeline -->
            <div id="mobile-timeline" class="md:hidden bg-white rounded-xl shadow-md p-6 mb-8">
                <div class="space-y-8">
                    <!-- Steps will be inserted here by JavaScript -->
                </div>
            </div>

            <!-- Order Details Card -->
            <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-md overflow-hidden">
                <div class="p-6">
                    <h3 class="text-lg font-medium text-gray-800 mb-4">অর্ডার বিবরণ</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <p class="text-gray-600">পণ্যের নাম:</p>
                            <p class="font-medium" id="product-name"></p>
                        </div>
                        <div>
                            <p class="text-gray-600">পরিমাণ:</p>
                            <p class="font-medium" id="product-quantity"></p>
                        </div>
                        <div>
                            <p class="text-gray-600">ক্রেতার নাম:</p>
                            <p class="font-medium" id="customer-name"></p>
                        </div>
                        <div>
                            <p class="text-gray-600">ডেলিভারি ঠিকানা:</p>
                            <p class="font-medium" id="delivery-address"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Not Found Message -->
        <div id="not-found" class="hidden max-w-lg mx-auto bg-white rounded-xl shadow-md p-8 text-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto text-red-500 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <h3 class="text-xl font-medium text-gray-800 mb-2">অর্ডার খুঁজে পাওয়া যায়নি</h3>
            <p class="text-gray-600">দয়া করে সঠিক অর্ডার আইডি প্রবেশ করান এবং আবার চেষ্টা করুন</p>
        </div>

        <!-- Loading Spinner -->
        <div id="loading" class="hidden fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50">
            <div class="bg-white p-6 rounded-lg shadow-lg flex items-center">
                <svg class="animate-spin -ml-1 mr-3 h-8 w-8 text-green-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                <span class="text-gray-700">অর্ডার তথ্য খুঁজছি...</span>
            </div>
        </div>
    </div>

    <script>
        // Order status flow
        const STATUS_FLOW = [
            "অর্ডার রিসিভড",
            "অর্ডার কনফার্মড", 
            "প্রসেসিং",
            "প্যাকড",
            "শিপড",
            "ট্রানজিট",
            "ডেলিভার্ড"
        ];

        // Status badge colors
        const STATUS_COLORS = {
            "অর্ডার রিসিভড": "bg-blue-100 text-blue-800",
            "অর্ডার কনফার্মড": "bg-indigo-100 text-indigo-800",
            "প্রসেসিং": "bg-purple-100 text-purple-800",
            "প্যাকড": "bg-yellow-100 text-yellow-800",
            "শিপড": "bg-orange-100 text-orange-800",
            "ট্রানজিট": "bg-amber-100 text-amber-800",
            "ডেলিভার্ড": "bg-green-100 text-green-800"
        };

        // Track order function
        async function trackOrder() {
            const orderId = document.getElementById('orderId').value.trim();
            
            if (!orderId) {
                alert("দয়া করে একটি অর্ডার আইডি লিখুন");
                return;
            }

            // Show loading spinner
            document.getElementById('loading').classList.remove('hidden');
            
            try {
                // Replace with your actual Apps Script URL
                const response = await fetch(`YOUR_APPS_SCRIPT_URL?orderId=${orderId}`);
                const data = await response.json();
                
                // Hide loading spinner
                document.getElementById('loading').classList.add('hidden');
                
                if (data.status === 'Not Found') {
                    // Show not found message
                    document.getElementById('results').classList.add('hidden');
                    document.getElementById('not-found').classList.remove('hidden');
                } else {
                    // Show results
                    document.getElementById('not-found').classList.add('hidden');
                    document.getElementById('results').classList.remove('hidden');
                    
                    // Update order details
                    updateOrderDetails(data);
                    
                    // Render timelines
                    renderTimeline(data.status);
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('loading').classList.add('hidden');
                alert("একটি ত্রুটি ঘটেছে। দয়া করে পরে আবার চেষ্টা করুন।");
            }
        }

        // Update order details in the UI
        function updateOrderDetails(data) {
            document.getElementById('order-id-display').textContent = `অর্ডার আইডি: ${data.orderId || 'N/A'}`;
            document.getElementById('order-date').textContent = data.orderDate || 'N/A';
            document.getElementById('product-name').textContent = data.productName || 'N/A';
            document.getElementById('product-quantity').textContent = data.quantity || 'N/A';
            document.getElementById('customer-name').textContent = data.customerName || 'N/A';
            document.getElementById('delivery-address').textContent = data.deliveryAddress || 'N/A';
            
            // Update status badge
            const statusBadge = document.getElementById('status-badge');
            statusBadge.textContent = data.status;
            statusBadge.className = `px-4 py-2 rounded-full text-sm font-medium ${STATUS_COLORS[data.status] || 'bg-gray-100 text-gray-800'}`;
        }

        // Render the timeline based on current status
        function renderTimeline(currentStatus) {
            const desktopTimeline = document.getElementById('desktop-timeline').querySelector('div');
            const mobileTimeline = document.getElementById('mobile-timeline').querySelector('div');
            
            // Clear existing content
            desktopTimeline.innerHTML = '';
            mobileTimeline.innerHTML = '';
            
            // Get the index of current status
            const currentIndex = STATUS_FLOW.indexOf(currentStatus);
            
            // Generate desktop timeline
            STATUS_FLOW.forEach((status, index) => {
                const isCompleted = index <= currentIndex;
                const isLast = index === STATUS_FLOW.length - 1;
                
                // Desktop step
                const desktopStep = document.createElement('div');
                desktopStep.className = 'flex flex-col items-center';
                
                // Step circle
                const stepCircle = document.createElement('div');
                stepCircle.className = `w-12 h-12 rounded-full flex items-center justify-center mb-2 ${isCompleted ? 'bg-green-500 text-white' : 'bg-gray-200 text-gray-600'}`;
                stepCircle.innerHTML = isCompleted ? '<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>' : (index + 1);
                
                // Step label
                const stepLabel = document.createElement('span');
                stepLabel.className = `text-sm ${isCompleted ? 'font-medium text-gray-800' : 'text-gray-500'}`;
                stepLabel.textContent = status;
                
                desktopStep.appendChild(stepCircle);
                desktopStep.appendChild(stepLabel);
                desktopTimeline.appendChild(desktopStep);
                
                // Add connector if not last step
                if (!isLast) {
                    const connector = document.createElement('div');
                    connector.className = `step-connector ${isCompleted ? 'active' : ''}`;
                    desktopTimeline.appendChild(connector);
                }
            });
            
            // Generate mobile timeline
            STATUS_FLOW.forEach((status, index) => {
                const isCompleted = index <= currentIndex;
                const isLast = index === STATUS_FLOW.length - 1;
                
                // Mobile step container
                const mobileStep = document.createElement('div');
                mobileStep.className = 'flex';
                
                // Step circle and line container
                const stepContainer = document.createElement('div');
                stepContainer.className = 'flex flex-col items-center mr-4';
                
                // Step circle
                const stepCircle = document.createElement('div');
                stepCircle.className = `w-12 h-12 rounded-full flex items-center justify-center ${isCompleted ? 'bg-green-500 text-white' : 'bg-gray-200 text-gray-600'}`;
                stepCircle.innerHTML = isCompleted ? '<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>' : (index + 1);
                
                // Add to container
                stepContainer.appendChild(stepCircle);
                
                // Add connector if not last step
                if (!isLast) {
                    const connector = document.createElement('div');
                    connector.className = `mobile-step-connector ${isCompleted ? 'active' : ''}`;
                    stepContainer.appendChild(connector);
                }
                
                // Step content
                const stepContent = document.createElement('div');
                stepContent.className = 'flex-1';
                
                // Step title
                const stepTitle = document.createElement('h4');
                stepTitle.className = `font-medium ${isCompleted ? 'text-gray-800' : 'text-gray-500'}`;
                stepTitle.textContent = status;
                
                // Step description (optional)
                const stepDesc = document.createElement('p');
                stepDesc.className = 'text-sm text-gray-500 mt-1';
                stepDesc.textContent = getStatusDescription(status);
                
                stepContent.appendChild(stepTitle);
                stepContent.appendChild(stepDesc);
                
                mobileStep.appendChild(stepContainer);
                mobileStep.appendChild(stepContent);
                mobileTimeline.appendChild(mobileStep);
            });
        }

        // Helper function to get status descriptions
        function getStatusDescription(status) {
            const descriptions = {
                "অর্ডার রিসিভড": "আপনার অর্ডারটি সফলভাবে পেয়েছি",
                "অর্ডার কনফার্মড": "অর্ডারটি কনফার্ম করা হয়েছে",
                "প্রসেসিং": "আপনার অর্ডারটি প্রস্তুত করা হচ্ছে",
                "প্যাকড": "পণ্যটি প্যাকেজিং করা হয়েছে",
                "শিপড": "পণ্যটি ডেলিভারি পার্টনারকে দেওয়া হয়েছে",
                "ট্রানজিট": "পণ্যটি আপনার দিকে আসছে",
                "ডেলিভার্ড": "পণ্যটি সফলভাবে ডেলিভার করা হয়েছে"
            };
            return descriptions[status] || "";
        }

        // Allow searching by pressing Enter key
        document.getElementById('orderId').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                trackOrder();
            }
        });
    </script>
</body>
</html>